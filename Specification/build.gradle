/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/8.7/samples
 */

plugins {
    id 'java-library'
    id 'maven-publish'
    id 'com.github.bjornvester.xjc' version '1.8.2'
}

repositories {
    mavenLocal()
    mavenCentral()
    gradlePluginPortal()
}

def xsdPath = "../../SGrSpecifications/SchemaDatabase/SGr"
def os = System.getProperty('os.name').toLowerCase()

java {
    sourceCompatibility = JavaVersion.VERSION_11
    targetCompatibility = JavaVersion.VERSION_11
}

xjc {
    xsdDir.set(layout.projectDirectory.dir(xsdPath))
    bindingFiles.setFrom(layout.projectDirectory.dir("src/main/xjb").asFileTree.matching { include("*.xjb") })
    useJakarta = true
    addCompilationDependencies = false
    generateEpisode = true
}

processResources {
    from xsdPath
    exclude '.gitkeep', 'ressources'
}

dependencies {
    api group: 'jakarta.xml.bind', name: 'jakarta.xml.bind-api', version: '4.0.2'
    compileOnly group: 'com.sun.xml.bind', name: 'jaxb-impl', version: '4.0.5'
}

publishing {
    java {
        withSourcesJar()
    }

    sourcesJar {
        exclude '.gitkeep'
    }

    repositories {
        maven {
            name = "Nexus"

            if (version.toString().contains('SNAPSHOT')) {
                url = uri("https://nexus.library.smartgridready.ch/repository/maven-snapshots/")
            } else {
                url = uri("https://nexus.library.smartgridready.ch/repository/maven-releases")
            }

            credentials {
                username = findProperty("nexus.username")
                password = findProperty("nexus.password")
            }
        }
    }

    publications {
        mavenJava(MavenPublication) {
            groupId = 'com.smartgridready'
            artifactId = 'sgr-specification'

            from components.java
        }
    }
}
